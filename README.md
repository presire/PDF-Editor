# PDF編集ツール

> ブラウザで完結するセキュアなPDFページ編集アプリケーション

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](https://opensource.org/licenses/MIT)  
[![Tailwind CSS](https://img.shields.io/badge/Tailwind_CSS-v4-38B2AC?logo=tailwind-css)](https://tailwindcss.com)  
[![pdf-lib](https://img.shields.io/badge/pdf--lib-latest-red)](https://pdf-lib.js.org/)  

## 目次

- [概要](#概要)
- [主な機能](#主な機能)
- [ファイル構成](#ファイル構成)
- [セットアップ](#セットアップ)
- [使用方法](#使用方法)
  - [ページ削除](#ページ削除)
  - [ページ挿入](#ページ挿入)
- [技術仕様](#技術仕様)
- [ブラウザ互換性](#ブラウザ互換性)
- [セキュリティについて](#セキュリティについて)
- [トラブルシューティング](#トラブルシューティング)
- [FAQ](#faq)
- [ライセンス](#ライセンス)
- [更新履歴](#更新履歴)

## 概要

このツールは、Webブラウザ上で動作するPDFページ編集アプリケーションです。  
サーバへのアップロードが不要で、クライアント側で完結するため、セキュアな環境でPDFファイルのページ挿入および削除が可能です。  

### 特徴

- 🔒 **完全クライアントサイド**: ファイルがサーバーに送信されることはなく、すべてブラウザ内で処理されます
- 🚀 **高速処理**: pdf-libによる効率的なPDF操作
- 🎨 **モダンなUI**: Tailwind CSSを使用した直感的で洗練されたデザイン
- 📱 **レスポンシブ対応**: デスクトップからタブレットまで、様々な画面サイズに対応
- 🖱️ **ドラッグ&ドロップ**: ファイル選択がスムーズで快適な操作性

## 主な機能

### ページ挿入機能
- ✅ 単一ページ挿入（例: `1`）
- ✅ 複数ページ挿入（例: `1,3,5`）
- ✅ 範囲指定挿入（例: `1-3`）
- ✅ 柔軟な挿入位置の指定
  - `0`を指定すると最初に挿入
  - `1`を指定すると1ページ目の後に挿入
- ✅ 異なるPDFファイルからのページ挿入

### ページ削除機能
- ✅ 単一ページ削除（例: `2`）
- ✅ 複数ページ削除（例: `1,3,5`）
- ✅ 範囲指定削除（例: `1-3`）
- ✅ 最低1ページは保持（安全機能）

### UI/UX
- ✅ ドラッグ&ドロップによるファイル読み込み
- ✅ リアルタイムのファイル情報表示
- ✅ 直感的なページ番号指定
- ✅ File System Access APIによる保存先選択（対応ブラウザ）
- ✅ エラーハンドリングと詳細なエラーメッセージ

## ファイル構成

```
📁 プロジェクトルート
├── 📄 pdf-editor.html           # メインHTMLファイル
├── 📄 README.md                 # このファイル
├── 📁 css/
│   └── 📄 tailwind.css          # Tailwind CSS
├── 📁 js/
│   └── 📄 pdf-lib.min.js        # PDF操作ライブラリ
└── 📁 img/
    ├── 📄 Delete.png            # ページ削除画面のスクリーンショット
    └── 📄 Insert.png            # ページ挿入画面のスクリーンショット
```

### 各ファイルの説明

#### `pdf-editor.html`
メインのHTMLファイル。PDF編集ロジック、UI、イベントハンドリングがすべて含まれています。

#### `css/tailwind.css`
Tailwind CSSのスタイルシート。レスポンシブなレイアウト、ユーティリティクラスを提供します。

#### `js/pdf-lib.min.js`
pdf-libライブラリ。PDFの読み込み、ページ操作、保存機能を提供します。

#### `img/`
スクリーンショット画像を格納するディレクトリ。

## セットアップ

### 必要な環境

- モダンなWebブラウザ
  - **推奨**: Chrome 90+、Edge 90+、Opera 76+
  - **制限付き**: Firefox 88+（File System Access API非対応）
  - **非推奨**: Safari（互換性の問題がある場合があります）

### インストール手順

1. **ファイルのダウンロード**
   
   すべてのファイルをダウンロードし、以下のフォルダ構造を保持してください。

2. **ファイル配置**
   
   ```
   your-folder/
   ├── pdf-editor.html
   ├── css/
   │   └── tailwind.css
   ├── js/
   │   └── pdf-lib.min.js
   └── img/
       ├── Delete.png
       └── Insert.png
   ```

3. **ブラウザで開く**
   
   `pdf-editor.html` をダブルクリックするか、ブラウザにドラッグ&ドロップしてください。

> **注意**:  
> ローカルファイルとして開く場合、一部のブラウザでファイル選択機能に制限がある場合があります。  
> その場合は、簡易的なHTTPサーバーを使用してください。

```bash
# Pythonの簡易HTTPサーバーを使用する例
python -m http.server 8000
# ブラウザで http://localhost:8000/pdf-editor.html にアクセス
```

## 使用方法

### ページ削除

#### ステップ1: ファイルの選択
1. **挿入先PDFファイルエリア**をクリック、またはファイルをドラッグ&ドロップ
2. 編集対象のPDFファイルを選択
3. ファイル情報（名前、サイズ）が表示されます

#### ステップ2: 削除モードの選択
1. 「**ページ削除**」ボタンをクリック
2. 削除用のUIが表示されます

#### ステップ3: ページ番号の指定

削除したいページ番号を以下の形式で入力：

**単一ページの削除**
```
2
```
→ 2ページ目のみを削除

**複数ページの削除**
```
1,3,5
```
→ 1、3、5ページ目を削除

**範囲指定の削除**
```
1-3
```
→ 1〜3ページ目を削除

**組み合わせ**
```
1,3-5,7
```
→ 1、3〜5、7ページ目を削除

#### ステップ4: 削除の実行
1. 「**削除を実行**」ボタンをクリック
2. 処理が完了すると、編集済みPDFがダウンロードされます

#### ステップ5: ファイルの保存
- **Chrome/Edge/Opera**: File System Access APIにより保存先ダイアログが表示されます
- **Firefox**: ブラウザのデフォルトダウンロードフォルダに自動保存されます

### ページ挿入

#### ステップ1: ファイルの選択

**挿入先PDFファイル**
1. **挿入先PDFファイルエリア**にベースとなるPDFファイルをドラッグ&ドロップ
2. または「ファイルを選択」ボタンから選択

**挿入元PDFファイル**
1. 「**ページ挿入**」ボタンをクリック
2. **挿入元PDFファイルエリア**に挿入したいページを含むPDFファイルをドラッグ&ドロップ
3. または「ファイルを選択」ボタンから選択

#### ステップ2: ページ番号と挿入位置の指定

**挿入元のページ番号**
```
1
```
→ 挿入元PDFの1ページ目のみを挿入

```
1,3,5
```
→ 挿入元PDFの1、3、5ページ目を挿入

```
1-3
```
→ 挿入元PDFの1〜3ページ目を挿入

**挿入先の位置**
```
0
```
→ 挿入先PDFの最初に挿入

```
1
```
→ 挿入先PDFの1ページ目の後に挿入

```
5
```
→ 挿入先PDFの5ページ目の後に挿入

#### ステップ3: 挿入の実行
1. 「**挿入を実行**」ボタンをクリック
2. 処理が完了すると、編集済みPDFがダウンロードされます

#### ステップ4: ファイルの保存
- **Chrome/Edge/Opera**: 保存先を選択できるダイアログが表示されます
- **Firefox**: デフォルトダウンロードフォルダに自動保存されます

## 技術仕様

### 使用技術

| 技術 | バージョン | 用途 |
|------|----------|------|
| HTML5 | - | ページ構造とマークアップ |
| CSS3 | - | スタイリング |
| JavaScript (ES6+) | - | アプリケーションロジック |
| Tailwind CSS | v4 | レスポンシブデザインとスタイリング |
| pdf-lib | 最新版 | PDF操作ライブラリ |
| File System Access API | - | ファイル保存ダイアログ（対応ブラウザのみ） |

### 処理の仕組み

#### ページ削除
1. PDFファイルを読み込み、pdf-libでパース
2. 指定されたページ番号をパース（単一、複数、範囲に対応）
3. 削除対象外のページを新しいPDFドキュメントにコピー
4. 新しいPDFを保存してダウンロード

#### ページ挿入
1. 挿入先PDFと挿入元PDFをそれぞれ読み込み
2. 挿入元から指定されたページを取得
3. 挿入先の指定位置にページをコピー
4. 新しいPDFを保存してダウンロード

### ファイルサイズ制限

- **推奨最大サイズ**: 50MB
- **理論上の最大サイズ**: ブラウザのメモリに依存

大きなPDFファイルや複雑な構造を持つPDFは処理に時間がかかる場合があります。

### 対応するPDFバージョン

- PDF 1.3〜1.7
- PDF 2.0（一部機能）

### ページ数の制限

- **最小ページ数**: 1ページ（削除後も最低1ページは残ります）
- **最大ページ数**: 制限なし（ただしブラウザのメモリに依存）

### File System Access APIについて

本ツールでは、ファイル保存時にFile System Access APIを使用しています。

**対応ブラウザ（Chrome、Edge、Opera）**
- ファイル保存ダイアログが表示されます
- 保存先を自由に選択できます
- ファイル名も変更可能です

**非対応ブラウザ（Firefox、Safari）**
- ブラウザのデフォルトダウンロードフォルダに自動保存されます
- ファイル名は自動的に付与されます
- ブラウザの設定で「ダウンロード時に保存場所を確認する」を有効にすることで、保存先を選択できます

> **Note**:  
> これはブラウザの仕様によるものであり、本ツールの制限ではありません。  
> Firefoxは将来的にFile System Access APIをサポートする予定です。

### 動作確認済み環境

- Google Chrome 120以降
- Microsoft Edge 120以降
- Opera 105以降
- Firefox 120以降（ファイル保存ダイアログは非対応）

## セキュリティについて

### セキュリティの特徴

✅ **クライアントサイド処理**
- すべてのPDF編集処理はブラウザ内で完結
- PDFファイルがサーバーに送信されることはありません
- インターネット接続なしでも動作可能（ローカルで完結）

✅ **プライバシー保護**
- ファイルの内容を外部に送信しません
- ブラウザのメモリ上でのみ処理
- ページを閉じるとすべてのデータがクリアされます

✅ **データの完全性**
- 元のPDFファイルは変更されません
- 編集後のPDFは新しいファイルとして保存されます
- 元のPDF品質を保持します

### セキュリティのベストプラクティス

#### 1. バックアップの作成
編集前に必ず元のPDFファイルのバックアップを取ってください。

#### 2. 信頼できる環境での使用
- 公共のコンピューターでの使用は避けてください
- マルウェア対策ソフトウェアを最新の状態に保ってください
- 信頼できるブラウザを使用してください

#### 3. ファイルの確認
編集後のPDFファイルを開いて、意図した通りに編集されているか確認してください。

### セキュリティの制限事項

⚠️ **注意すべき点**

1. **ブラウザのセキュリティ**
   - ブラウザ拡張機能がデータにアクセスできる可能性があります
   - キーロガーやマルウェアからは保護されません

2. **メモリ上のデータ**
   - 処理中はメモリ上にPDFデータが存在します
   - ページを閉じるとクリアされます

3. **保護されたPDF**
   - パスワード保護されたPDFは開けません
   - 編集制限のあるPDFは正常に処理できない場合があります

4. **メタデータの保持**
   - 一部のメタデータやフォーム情報が失われる可能性があります
   - 重要なメタデータが含まれる場合は注意してください

## トラブルシューティング

### よくある問題と解決方法

#### ❌ 「エラーが発生しました」と表示される

**原因と解決方法：**

1. **PDFファイルが破損している**
   - 別のPDFビューアで開けるか確認
   - 可能であれば、PDFを再生成

2. **保護されたPDF**
   - パスワードを解除してから再試行
   - 編集権限があるか確認

3. **ファイルサイズが大きすぎる**
   - 50MB以下のファイルを推奨
   - 大きなファイルは分割してから処理

4. **ブラウザのメモリ不足**
   - 他のタブを閉じる
   - ブラウザを再起動
   - より多くのメモリを搭載したPCを使用

#### ❌ ページ番号の指定が無効と表示される

**解決方法：**

正しい形式で入力してください：
- ✅ 正: `1,3,5` または `1-3`
- ❌ 誤: `1, 3, 5` （スペース）
- ❌ 誤: `1～3` （全角チルダ）
- ❌ 誤: `a,b,c` （数字以外）

#### ❌ ファイルがダウンロードされない

**解決方法：**
- ブラウザのダウンロード設定を確認
- ポップアップブロックを確認
- ダウンロードフォルダの容量を確認
- 別のブラウザで試す

#### ❌ すべてのページを削除しようとするとエラー

**説明：**  
これは意図的な動作です。PDFファイルは最低1ページ必要なため、すべてのページを削除することはできません。

**解決方法：**  
少なくとも1ページは残してください。

#### ❌ Firefox で保存先を選択できない

**説明：**  
Firefoxは現在File System Access APIをサポートしていないため、ファイルは自動的にデフォルトダウンロードフォルダに保存されます。

**解決方法：**
1. Firefoxの設定で「ダウンロード時に保存場所を確認する」を有効にする
2. または、Chrome/Edge/Operaを使用する

### デバッグ方法

問題が解決しない場合、ブラウザの開発者ツールで詳細を確認：

1. **F12キー**を押して開発者ツールを開く
2. **Console**タブを選択
3. エラーメッセージを確認
4. エラーメッセージをコピーして検索

## FAQ

### Q1: このツールは安全ですか？

**A:**  
はい、安全です。  
すべての処理がブラウザ内で完結し、PDFファイルがインターネット上に送信されることはありません。  
ただし、信頼できる環境（自分のPC、信頼できるブラウザ）で使用することを推奨します。

### Q2: インターネット接続は必要ですか？

**A:**  
いいえ、必要ありません。  
すべてのファイル（HTML、CSS、JavaScript、pdf-lib）をローカルに配置すれば、オフラインでも動作します。  
初回読み込み時のみ、CDNからのリソース読み込みが必要な場合があります。

### Q3: どのくらい大きなPDFファイルを処理できますか？

**A:**  
ブラウザのメモリに依存しますが、50MB以下を推奨します。  
それより大きいファイルは処理に時間がかかるか、メモリ不足でエラーになる可能性があります。

### Q4: 元のPDFファイルは変更されますか？

**A:**  
いいえ、変更されません。  
編集後のPDFは新しいファイルとして保存され、元のファイルはそのまま残ります。

### Q5: 複数のPDFファイルを一度に編集できますか？

**A:**  
現在のバージョンでは1つのPDFファイルずつの処理となります。  
複数のファイルを処理する場合は、1つずつ編集してください。

### Q6: モバイルデバイスでも使えますか？

**A:**  
はい、使用できます。  
レスポンシブデザインのため、スマートフォンやタブレットでも使用できます。  
ただし、大きなファイルの処理はPCを推奨します。

### Q7: PDFの品質は劣化しますか？

**A:**  
基本的に劣化しません。  
pdf-libは元のPDF品質を保持しますが、一部のメタデータやフォーム情報が失われる可能性があります。

### Q8: パスワード保護されたPDFは編集できますか？

**A:**  
いいえ、できません。  
パスワード保護や編集制限のあるPDFは、まず保護を解除してから編集してください。

### Q9: 商用利用は可能ですか？

**A:**  
はい、可能です。  
MITライセンスの下で配布されているため、商用・非商用問わず自由に使用できます。

### Q10: 他のPDF編集ツールとの互換性はありますか？

**A:**  
はい、互換性があります。  
本ツールで編集したPDFは、Adobe Acrobat、PDF-XChange、他のPDFビューアで正常に開けます。

### Q11: ページの順序を変更できますか？

**A:**  
直接的な順序変更機能はありませんが、以下の方法で実現できます：
1. 必要なページを削除
2. 別のPDFファイルとして保存
3. ページ挿入機能で希望の順序に再構成

### Q12: Firefoxで使用する際の注意点は？

**A:**  
Firefoxでは以下の点に注意してください：
- File System Access API非対応のため、ファイルは自動的にデフォルトダウンロードフォルダに保存されます
- Firefoxの設定で「ダウンロード時に保存場所を確認する」を有効にすると、保存先を選択できます
- 基本的な機能はすべて使用可能です

## ライセンス

```
MIT License

Copyright (c) 2025 Presire

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

## 🔗 関連リンク

- [pdf-lib Documentation](https://pdf-lib.js.org/)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
- [File System Access API](https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API)
- [MDN Web Docs - PDF](https://developer.mozilla.org/en-US/docs/Glossary/PDF)

---

**最終更新**: 2025年11月  
